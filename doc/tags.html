<!-- $Id$ -->
<HTML><HEAD>
<CENTER><TITLE>tags</TITLE>
</HEAD>
<BODY BGCOLOR=WHITE></CENTER><p><hr>

<H1> 
<A NAME="tags_minivend_0">
MINIVEND TAG REFERENCE</A>
</H1>
<p>
<DL COMPACT>
<DT><STRONG>

<A NAME="tags_calc_0">
[/calc]</A>

</STRONG>
<DD>
Terminates the calculated region.
<p>
<DT><STRONG>

<A NAME="tags_col_0">
[/col]</A>

</STRONG>
<DD>
Terminates the column field.
<p>
<DT><STRONG>

<A NAME="tags_if_0">
[/if]</A>

</STRONG>
<DD>
Terminates an if conditional.
<p>
<DT><STRONG>

<A NAME="tags_if_data_0">
[/if_data]</A>

</STRONG>
<DD>
Terminates an [if_field fieldname] element.
<p>
<DT><STRONG>

<A NAME="tags_if_field_0">
[/if_field]</A>

</STRONG>
<DD>
Terminates an [if_field fieldname] element.
<p>COMPATIBILITY NOTE: MiniVend 1.02 used the [/if] end tag for
an [if_field] element. This was supported through MiniVend 1.03,
but is gone in 2.0 -- you may need to change it.
<p>
<DT><STRONG>

<A NAME="tags_if_loop_data_0">
[/if_loop_data]</A>

</STRONG>
<DD>
Alias for [/if_data] valid only in [loop list] [/loop].
<p>
<DT><STRONG>

<A NAME="tags_if_loop_field_0">
[/if_loop_field]</A>

</STRONG>
<DD>
Alias for [/if_field] valid only in [loop list] [/loop].
<p>COMPATIBILITY NOTE: MiniVend 1.02 used the [/if] end tag for
an [if_field] element. This was supported through MiniVend 1.03,
but is gone in 2.0 -- you may need to change it.
<p>
<DT><STRONG>

<A NAME="tags_item_list_0">
[/item_list]</A>

</STRONG>
<DD>
Terminates the [item_list] tag.
<p>
<DT><STRONG>

<A NAME="tags_more_list_0">
[/more_list]</A>

</STRONG>
<DD>
Terminates the [more_list] tag.  
<p>
<DT><STRONG>

<A NAME="tags_order_0">
[/order]</A>

</STRONG>
<DD>
Expands into &lt;/a&gt;. Used with the order element, such as: Buy a
[order TK112]Toaster[/order] today.
<p>
<DT><STRONG>

<A NAME="tags_page_0">
[/page], [/pagetarget]</A>

</STRONG>
<DD>
Expands into &lt;/a&gt;. Used with the page or pagetarget elements, such as:
[page shirts]Our shirt collection[/page] or [pagetarget pants main] Our
pants collection[/pagetarget].  They are syntactically the same, so
you can use either one to terminate an anchor -- the two different ones
are provided for consistency.  It will very slightly improve MiniVend
performance if you simply use &lt;/A> instead.
<p>
<DT><STRONG>

<A NAME="tags_row_0">
[/row]</A>

</STRONG>
<DD>
Terminates a [row nn] element.
<p>
<DT><STRONG>

<A NAME="tags_search_list_0">
[/search_list]</A>

</STRONG>
<DD>
Ends the search list.  
<p>
<DT><STRONG>

<A NAME="tags_accessories_0">
[accessories code]</A>

</STRONG>
<DD>
Expands into the value of the accessories database entry for the product
identified by <EM>code</EM> as found in the products database.
<p>
<DT><STRONG>

<A NAME="tags_area_0">
[area pg]</A>

</STRONG>
<DD>
Like the <EM>areatarget</EM> element, except it will never yield
a frame target.
<p>
<DT><STRONG>

<A NAME="tags_areatarget_0">
[areatarget pg frame]</A>

</STRONG>
<DD>
Inserts a Vend URL in a format to provide a targeted reference for a
client-side imagemap.  You set up the &lt;AREA> tag with:
<p>
<XMP>
      <AREA COORDS="220,0,270,20" HREF="[areatarget page frame]">

</XMP>
<p>If frames are enabled, this will expand to:
<p>
<XMP>
      <AREA COORDS="220,0,270,20"
         HREF="http://machine.company.com/vlink/page?ErTxVV8l;;38" TARGET="frame">

</XMP>
<p>If frames are <EM>not</EM> enabled, this will expand to:
<p>
<XMP>
      <AREA COORDS="220,0,270,20"
         HREF="http://machine.company.com/vlink/page?ErTxVV8l;;38">

</XMP>
<p>
<DT><STRONG>

<A NAME="tags_body_0">
[body n]</A>

</STRONG>
<DD>
Selects from the predefined color schemes and/or backgrounds, and
just becomes a &lt;BODY> tag if none are defined. See 
<EM>Controlling Page Appearance</EM>.
<p>
<DT><STRONG>

<A NAME="tags_buttonbar_0">
[buttonbar n]</A>

</STRONG>
<DD>
Selects from the predefined buttonbars, and is stripped if it
doesn't exist. See <EM>Controlling Page Appearance</EM>.
<p>
<DT><STRONG>

<A NAME="tags_calc_1">
[calc]</A>

</STRONG>
<DD>
Starts a region where the arguments are calculated according to normal
arithmetic symbols. For instance:
<p>
<XMP>
    [calc] 2 + 2 [/calc]

</XMP>
<p>will display:
<p>
<XMP>
    4

</XMP>
<p>
<DT><STRONG>

<A NAME="tags_cart_0">
[cart name]</A>

</STRONG>
<DD>
Sets the name of the current shopping cart for display of shipping, price,
total, subtotal, and nitems tags.  If you wish to use a different price for
the cart, all of the above except [nitems] and [shipping] will reflect the
normal price field -- you must emulate those operations with embedded Perl
or the [item-list], [calc], and [currency] tags.
<p>
<DT><STRONG>

<A NAME="tags_checked_0">
[checked var_name value]</A>

</STRONG>
<DD>
This will output CHECKED if the variable <EM>var_name</EM> is equal to

<A HREF="tags.html#tags_value_0">value</A>
.  Not case sensitive.
<p>
<DT><STRONG>

<A NAME="tags_col_1">
[col width=nn wrap=yes|no gutter=n align=left|right|input spacing=n]</A>

</STRONG>
<DD>
Sets up a column for use in a [row]. This parameter can only be contained
inside a [row nn] [/row] tag pair.  Any number of columns (that fit within
the size of the row) can be defined.
<p>The parameters are:
<p>
<XMP>
    width=nn        The column width, I<including the gutter>. Must be
                    supplied, there is no default.  A shorthand method
                    is to just supply the number as the I<first> parameter,
                    as in [col 20].
        
    gutter=n        The number of spaces used to separate the column (on
                    the right-hand side) from the next. Default is 2.
        
    spacing=n       The line spacing used for wrapped text. Default is 1,
                    or single-spaced.
        
    wrap=(yes|no)   Determines whether text that is greater in length than
                    the column width will be wrapped to the next line. Default
                    is I<yes>.
        
    align=(L|R|I)   Determines whether text is aligned to the left (the default),
                    the right, or in a way that might display an HTML text
                    input field correctly.

</XMP>
<p>
<DT><STRONG>

<A NAME="tags_currency_0">
[currency]</A>

</STRONG>
<DD>
When passed a value of a single number, formats it according to the
currency specification. For instance:
<p>
<XMP>
    [currency]4[/currency]

</XMP>
<p>will display:
<p>
<XMP>
    4.00

</XMP>
<p>Uses the <EM>Locale</EM>, <EM>PriceDivide</EM>, and <EM>PriceComma</EM> settings as
appropriate, and can contain a [calc] region.  If Locale is set to 'pt',
and <EM>PriceDivide</EM> to 100, the following
<p>
<XMP>
    [currency] [calc] 50000 + 100000 [/calc] [/currency]

</XMP>
<p>the number 1.500,00 will be displayed.
<p>
<DT><STRONG>

<A NAME="tags_data_0">
[data area field key]</A>

</STRONG>
<DD>
Returns the value of the field in any of the arbitrary databases,
or from the variable namespaces.  Databases will hide variables, so
don't name a database ``session'', ``scratch'', or any of the other
reserved names! Case is sensitive, so in a pinch you could call the
database ``Session'', but it would be better not to.
<p>
<DT><STRONG>

<A NAME="tags_description_0">
[description code]</A>

</STRONG>
<DD>
Expands into the description of code as found in the products
database.
<p>
<DT><STRONG>

<A NAME="tags_else_0">
[else] text [/else]</A>

</STRONG>
<DD>
The optional else-text for an if or if_field conditional.
<p>
<DT><STRONG>

<A NAME="tags_field_0">
[field name code]</A>

</STRONG>
<DD>
Expands into the value of the field <EM>name</EM> for the product
identified by <EM>code</EM> as found in the products database.
<STRONG>IMPORTANT:</STRONG> If the field name is not a field in the
database, the MiniVend server will stop with an error.
<p>
<DT><STRONG>

<A NAME="tags_finish_order_0">
[finish_order page*]</A>

</STRONG>
<DD>
This element is used to give the customer, while browsing, a way to go
to the order page (or optional checkout page) after they have ordered
something. If they haven't ordered anything yet [finish_order] does not
appear at all on the displayed page. If they have ordered an item, the
element will expand into something like:
<p>
<XMP>
 <a href="http://machine.company.com/cgi-bin/vlink/order;WehUkATn;;1">
 Finish Incomplete Order</a>

</XMP>
<p>If the optional page is supplied, that will be the order page used
to finish the order.
<p>
<DT><STRONG>

<A NAME="tags_frames_off_0">
[frames_off]</A>

</STRONG>
<DD>
Turns off the frames processing option.  This can be used to disable
frames, perhaps as a clickable option for users.  It is persistent for
the entire session, or until counteracted with a [frames_on] tag.
<p>
<DT><STRONG>

<A NAME="tags_frames_on_0">
[frames_on]</A>

</STRONG>
<DD>
Turns on the frames processing option, which is disabled by default.
The proper way to use this is to put it ONLY in a page which is loaded
by frame-based browsers, as part of the initial frame load.  It is
persistent for the entire session, or until counteracted with a
[frames_off] tag.
<p>
<DT><STRONG>

<A NAME="tags_if_1">
[if type field op* compare*]</A>

</STRONG>
<DD>
Allows conditional building of HTML based on the setting of various MiniVend
session and database values. Accessible areas are:
<p>
<DL COMPACT>
<DT><STRONG>

<A NAME="tags_accessory_0">
accessory</A>

</STRONG>
<DD>
The accessories database.
<p>
<DT><STRONG>

<A NAME="tags_config_0">
config</A>

</STRONG>
<DD>
The MiniVend configuration variables. These are set
by the directives in your MiniVend configuration file (or
the defaults).
<p>
<DT><STRONG>

<A NAME="tags_explicit_0">
explicit</A>

</STRONG>
<DD>
Allows you to specify an explicit test, perhaps generated
from another MiniVend tag element. Uses Perl conditionals,
and strings may be quoted. You might do:
<p>
<XMP>
          [if explicit "[item-field category]" eq shirt] 
          This is a shirt.
          [else]
          Not a shirt.
          [/else]
          [/if]

</XMP>
<p>If the above is on a flypage, or within an [item-list], the [item-data]
tag will already be interpolated and replaced with the value of the
product database field <EM>category</EM>.  You should use quotes in case
the item field contains white space.
<p>
<DT><STRONG>

<A NAME="tags_salestax_0">
salestax</A>

</STRONG>
<DD>
The salestax database.
<p>
<DT><STRONG>

<A NAME="tags_scratch_0">
scratch</A>

</STRONG>
<DD>
The MiniVend scratchpad variables, which can be set
with the [set name]value[/set] element. 
<p>
<DT><STRONG>

<A NAME="tags_session_0">
session</A>

</STRONG>
<DD>
The MiniVend session variables. Of particular interest
are <EM>login</EM>, <EM>frames</EM>, <EM>secure</EM>, and <EM>browser</EM>.
<p>
<DT><STRONG>

<A NAME="tags_shipping_0">
shipping</A>

</STRONG>
<DD>
The shipping database.
<p>
<DT><STRONG>

<A NAME="tags_validcc_0">
validcc</A>

</STRONG>
<DD>
A special case, takes the form [if validcc no type exp_date].
Evaluates to true if the supplied credit card number, type
of card, and expiration date pass a validity test.  Does
checksum digit calculation to weed out typos or phony 
card numbers.
<p>
<DT><STRONG>

<A NAME="tags_value_0">
value</A>

</STRONG>
<DD>
The MiniVend user variables, typically set in search,
control, or order forms. Variables beginning with 'mv_'
are MiniVend special values, and should be tested/used
with caution.
<p>
</DL>
.
<p>
<DT><STRONG>

<A NAME="tags_item_list_1">
[item_list]</A>

</STRONG>
<DD>
Places an iterative list of the items in the shopping cart. 
Within any display page, the [item_list cart*] element shows a list of all the
items ordered by the customer so far. It works by repeating the source
between [item_list] and [/item_list] once for each item ordered.
Between the item_list markers the various [item] elements will return
information for the current item.
<p>
<DL COMPACT>
<DT><STRONG>

<A NAME="tags_if_data_1">
[if_data fieldname]</A>

</STRONG>
<DD>
If the arbitrary database field <EM>fieldname</EM> is non-blank, the following
text up to the [/if_data] tag is substituted. This can be used to
substitute IMG or other tags only if the corresponding source
item is present. Also accepts a [else]else text[/else] pair
for the opposite condition.
<p>
<DT><STRONG>

<A NAME="tags_if_field_1">
[if_field fieldname]</A>

</STRONG>
<DD>
If the database field <EM>fieldname</EM> is non-blank, the following
text up to the [/if_field] tag is substituted. This can be used to
substitute IMG or other tags only if the corresponding source
item is present. Also accepts a [else]else text[/else] pair
for the opposite condition.
<p>
<DT><STRONG>

<A NAME="tags_item_accessories_0">
[item_accessories]</A>

</STRONG>
<DD>
Evaluates to the value of the Accessories database entry for
the item.
<p>
<DT><STRONG>

<A NAME="tags_item_code_0">
[item_code]</A>

</STRONG>
<DD>
Evaluates to the product code for the current item.
<p>
<DT><STRONG>

<A NAME="tags_item_data_0">
[item_data database fieldname]</A>

</STRONG>
<DD>
Evaluates to the field name <EM>fieldname</EM> in the arbitrary database
table <EM>database</EM>, for the current item.
<p>
<DT><STRONG>

<A NAME="tags_item_description_0">
[item_description]</A>

</STRONG>
<DD>
Evaluates to the product description (from the products file)
for the current item.
<p>
<DT><STRONG>

<A NAME="tags_item_field_0">
[item_field fieldname]</A>

</STRONG>
<DD>
Evaluates to the field name <EM>fieldname</EM> in the database,  for
the current item.
<p>
<DT><STRONG>

<A NAME="tags_item_increment_0">
[item_increment]</A>

</STRONG>
<DD>
Evaluates to the number of the item in the match list. Used
for numbering search matches or order items in the list.
<p>
<DT><STRONG>

<A NAME="tags_item_link_0">
[item_link code]</A>

</STRONG>
<DD>
Expands into a hyperlink which will jump the user to a page
under the <EM>ItemLinkDir</EM> (default is the pages directory),
with anchor text as set in <EM>ItemLinkValue</EM> (default is ``More Details'').
If the page is not present, then <EM>flypage.html</EM> will be used to build
a page from the entry in the database.  If that doesn't work (perhaps
due to a missing flypage.html) then the error page <EM>notfound.html</EM> will
be displayed.  Only active in the search list.
<p>
<DT><STRONG>

<A NAME="tags_item_modifier_0">
[item_modifier attribute]</A>

</STRONG>
<DD>
Evaluates to the modifier value of <EM>attribute</EM> for the current item.
<p>
<DT><STRONG>

<A NAME="tags_item_price_0">
[item_price n*]</A>

</STRONG>
<DD>
Evaluates to the price for quantity <CODE>n</CODE> (from the products file)
of the current item.
<p>
<DT><STRONG>

<A NAME="tags_item_quantity_0">
[item_quantity]</A>

</STRONG>
<DD>
Evaluates to the quantity ordered for the current item.
<p>
<DT><STRONG>

<A NAME="tags_item_subtotal_0">
[item_subtotal]</A>

</STRONG>
<DD>
Evaluates to the subtotal (quantity * price) for the current item.
Quantity price breaks are taken into account.
<p>
</DL>
.
<p>
<DT><STRONG>

<A NAME="tags_loop_0">
[loop item,item,item] value [/loop]</A>

</STRONG>
<DD>
Returns a string consisting of the value, repeated for every item in a
comma-separated list.  Operates in the same fashion as the [item-list]
tag, except for order-item-specific values. Intended to pull multiple
attributes from an item modifier -- but can be useful for other things,
like building a pre-ordained product list on a page.
<p>Limited to 1024 values in the list.  Iteratively interprets the
following tags:
<p>
<DL COMPACT>
<DT><STRONG>

<A NAME="tags_if_data_2">
[if_data database fieldname] or [if_loop_data database fieldname]</A>

</STRONG>
<DD>
If the arbitrary <EM>database</EM> field <EM>fieldname</EM> is non-blank, the following
text up to the [/if_data] tag is substituted. This can be used to
substitute IMG or other tags only if the corresponding source
item is present. Also accepts a [else]else text[/else] pair
for the opposite condition.
<p>
<DT><STRONG>

<A NAME="tags_if_field_2">
[if_field fieldname] or [if_loop_field fieldname]</A>

</STRONG>
<DD>
If the product database field <EM>fieldname</EM> is non-blank, the following
text up to the [/if_field] tag is substituted. This can be used to
substitute IMG or other tags only if the corresponding source
item is present. Also accepts a [else]else text[/else] pair
for the opposite condition.
<p>
<DT><STRONG>

<A NAME="tags_loop_accessories_0">
[loop_accessories]</A>

</STRONG>
<DD>
Evaluates to the value of the Accessories database entry for
the item.
<p>
<DT><STRONG>

<A NAME="tags_loop_code_0">
[loop_code]</A>

</STRONG>
<DD>
Evaluates to the product code for the current item.
<p>
<DT><STRONG>

<A NAME="tags_loop_data_0">
[loop_data database fieldname]</A>

</STRONG>
<DD>
Evaluates to the field name <EM>fieldname</EM> in the arbitrary database
table <EM>database</EM>, for the current item.
<p>
<DT><STRONG>

<A NAME="tags_loop_description_0">
[loop_description]</A>

</STRONG>
<DD>
Evaluates to the product description (from the products file)
for the current item.
<p>
<DT><STRONG>

<A NAME="tags_loop_field_0">
[loop_field fieldname]</A>

</STRONG>
<DD>
Evaluates to the field name <EM>fieldname</EM> in the database,  for
the current item.
<p>
<DT><STRONG>

<A NAME="tags_loop_increment_0">
[loop_increment]</A>

</STRONG>
<DD>
Evaluates to the number of the item in the list. Used
for numbering items in the list.
<p>
<DT><STRONG>

<A NAME="tags_loop_price_0">
[loop_price n*]</A>

</STRONG>
<DD>
Evaluates to the price for optional quantity n (from the products file)
of the current item.
<p>
</DL>
.
<p>
<DT><STRONG>

<A NAME="tags_matches_0">
[matches]</A>

</STRONG>
<DD>
Replaced with the range of match numbers displayed by the
search page.  Looks something like ``1-50''. Make sure
you insert this item between a [more_list] and [/more_list]
element pair.
<p>
<DT><STRONG>

<A NAME="tags_modifier_name_0">
[modifier_name attribute]</A>

</STRONG>
<DD>
Evaluates to the name to give an input box in which the
customer can specify the modifier to the ordered item.
<p>
<DT><STRONG>

<A NAME="tags_more_0">
[more]</A>

</STRONG>
<DD>
Inserts a series of hyperlinks that will call up the next matches
in a series. They look like this:
<p>
<XMP>
    Previous 1 2 3 4 5 6 Next

</XMP>
<p>The current page will not be a hyperlink.  Every time the new
link is pressed, the list is re-built to correspond to the current
page.  If there is no <EM>Next</EM> or <EM>Previous</EM> page, that link
will not be shown.
<p>See the <EM>fr_resul.html</EM> or <EM>search.html</EM> files for examples. Make sure
you insert this item between a [more_list] and [/more_list] element pair.
<p>
<DT><STRONG>

<A NAME="tags_more_list_1">
[more_list]</A>

</STRONG>
<DD>
Starts the section of the search page which is only displayed
if there are more matches than specified in <EM>mv_matchlimit</EM>.
If there are less matches than the number in mv_matchlimit, all
text/html between the [more_list] and [/more_list] elements is
stripped.
<p>Use in conjunction with the [more] element to place pointers to
additional pages of matches.
<p>
<DT><STRONG>

<A NAME="tags_msql_0">
[msql array] SQL [/msql]</A>

</STRONG>
<DD>
A complete array of arrays, suitable for <EM>eval</EM> by Perl, can be returned
by this query.  This tag pair encloses any valid mSQL query, and returns
the results (if any) as a string representing rows and columns, in Perl
array syntax.  If placed in an embedded Perl area as:
<p>
<XMP>
 [perl]

</XMP>
<PRE>
    my <STRONG>$string</STRONG> =&lt;&lt;'EOF';
 [msql array]select * from arbitrary where code &lt;= '19'[/msql]
 EOF
    my $ary = eval $string;
    my $out = '';
        my $i;
    foreach $i (@$ary) {
        $out .= $i->[0];
        $out .= "<BR>";
    }
    $out;
 [/perl]

</PRE>
<p>NOTE: The 'EOF' string terminator must START the line, and not
have trailing characters.  DOS users, beware of carriage returns!
<p>
<DT><STRONG>

<A NAME="tags_msql_1">
[msql hash] SQL [/msql]</A>

</STRONG>
<DD>
A complete hash of hashes, suitable for <EM>eval</EM> by Perl, can be returned
by this query.  This tag pair encloses any valid mSQL query, and returns
the results (if any) as a string representing rows and columns, in Perl
associative array, or hash, syntax.  If placed in an embedded Perl area as:
<p>
<XMP>
 [perl]

</XMP>
<PRE>
    my <STRONG>$string</STRONG> =&lt;&lt;'EOF';
 [msql hash]select * from arbitrary where code &lt;= '19'[/msql]
 EOF
    my $hash = eval $string;
    my $out = '';
        my $key;
    foreach $key (keys %$hash) {
        $out .= $key->{field1};
        $out .= "<BR>";
    }
    $out;
 [/perl]

</PRE>
<p>
<DT><STRONG>

<A NAME="tags_msql_2">
[msql html] SQL [/msql]</A>

</STRONG>
<DD>
This tag returns a set of HTML table rows with <STRONG>bold</STRONG> field names at
the top, followed by each row in a set of table cells.  The &lt;TABLE&gt;
and &lt;/TABLE&gt; tags are not supplied, so you can set your own border
and shading options. Example:
<p>
<XMP>
  <TABLE BORDER=2>
  [msql html]select * from arbitrary where code > '19' order by field2[/msql]
  </TABLE>

</XMP>
<p>
<DT><STRONG>

<A NAME="tags_msql_3">
[msql list SQL] list [/msql]</A>

</STRONG>
<DD>
This tag differs from the rest in that it passes the query enclosed
inside the tag itself. The enclosed text is then evaluated with the
same method as with a search list, with data items (in columns) iterated
over for the contents of a list.  The following snippet will place
a three-column list in an HTML table:
<p>
<XMP>
  <TABLE BORDER=2>
  <TR><TH><B>SKU</B></TH><TH><B>Description</B></TH><TH><B>Price</B></TH>
  [msql list
        select * from arbitrary where code > '19' order by field2 ]
  <TR>
        <TD>[page [msql-code]][msql-code]</A></TD>
        <TD>[msql-param 1]</TD>
        <TD>[msql-param 2]</TD>
  </TR>
  [/msql]
  </TABLE>

</XMP>
<p>It uses the same tags as in the [loop_list], except prefixed
with <EM>msql</EM>. Available are the following, in order of interpolation:
<p>
<XMP>
  [msql_param n]        Field n of the returned query (in the row)
  [if_msql_field fld]   Returns enclosed text only product field not empty
  [/if_msql_field]      Terminator for above
  [if_msql_data db fld] Returns enclosed text only if data field not empty
  [/if_msql_field]      Terminator for above
  [msql_increment]      Returns integer count of row
  [msql_code]           The first field of each row returned
  [msql_data db fld]    Database field for [msql_code]
  [msql_description]    Product description for [msql_code]
  [msql_field fld]      Product field for [msql_code]
  [msql_link]           Same as item-link
  [msql_price q*]       Price for [msql_code], optional quantity q

</XMP>
<p>
<DT><STRONG>

<A NAME="tags_msql_4">
[msql param] SQL [/msql]</A>

</STRONG>
<DD>
A list of keys, or in fact any mSQL fields, can be returned as a set of
parameters suitable for passing to a program or list primitive. This tag pair
encloses any valid mSQL query, and returns the results (if any) as a series of
space separated fields, enclosed in quotes.  This folds the entire return
into a single row, so it may be used as a list of keys.
<p>
<DT><STRONG>

<A NAME="tags_msql_5">
[msql set] SQL [/msql]</A>

</STRONG>
<DD>
Any arbitrary SQL query can be passed with this method. No return
text will be sent.  This might be used for passing an order to an 
order database, perhaps on the order report or receipt page. An
example might be:
<p>
<XMP>
 [msql set]
         insert into orders
         values
          ('[value mv_order_number]',
           '[value name escape]',
           '[value address escape]',
           '[value city escape]',
           '[value state escape]',
           '[value zip escape]',
           '[value phone escape]',
           '[item-list]
                 Item: [item-code] Quan: [item-quantity] Price: [item-price]
                [/item-list]'
          )
 [/msql]

</XMP>
<p>The values entered by the user are escaped, which prevents errors if
quote characters have slipped into their entry.
<p>
<DT><STRONG>

<A NAME="tags_nitems_0">
[nitems cart*]</A>

</STRONG>
<DD>
Expands into the total number of items ordered so far. Takes an
optional cart name as a parameter.
<p>
<DT><STRONG>

<A NAME="tags_order_1">
[order code page*]</A>

</STRONG>
<DD>
Expands into a hypertext link which will include the specified
code in the list of products to order and display the order
page. code should be a product code listed in the ``products''
database.
<p>
<DT><STRONG>

<A NAME="tags_page_1">
[page pg]</A>

</STRONG>
<DD>
Insert a hyperlink to the specified catalog page pg. For
example, [page shirts] will expand into &lt;
a <A HREF="href=``http://machine.company.com/cgi-bin/vlink/shirts?WehUkATn;;1''>">href=``http://machine.company.com/cgi-bin/vlink/shirts?WehUkATn;;1''></A>. The
catalog page displayed will come from ``shirts.html'' in the
pages directory.
<p>
<DT><STRONG>

<A NAME="tags_pagetarget_0">
[pagetarget pg frame]</A>

</STRONG>
<DD>
Same as the page element above, except it specifies an output frame to
target if frames are turned on.  The name <EM>is</EM> case-sensitive, and if
it doesn't exist a new window will be popped up.  This is the same as
the [page ...] tag if frames are not activated.
For example, [pagetarget shirts main] will expand into a link like &lt;a
<A HREF="href=``http://machine.company.com/cgi-bin/vlink/shirts?WehUkATn;;1''">href=``http://machine.company.com/cgi-bin/vlink/shirts?WehUkATn;;1''</A> TARGET=``main''&gt;.
The catalog page displayed will come from ``shirts.html'' in the
pages directory, and be output to the 'main' frame.  Be careful,
frame names are case-sensitive.
<p>This option also allows specification of secure pages if the target ends with
the string <EM>__secure</EM> (which will be stripped).  If so specified,
the page will be called with <EM>SecureURL</EM> instead of <EM>VendURL</EM>.
<p>
<DT><STRONG>

<A NAME="tags_perl_0">
[perl args] code [/perl]</A>

</STRONG>
<DD>
See the section on <EM>Embedded Perl Code</EM>. The <EM>args</EM> are one of the following:
<p>
<XMP>
        =item values
        Gives read-write access to the user variables, including
        the MiniVend special variables, an anonymous hash.
        Referred to in your code as %values.
        =item items
        Gives read-only access to the items on order. This
        is an array of hashes, and includes the product
        code, quantity, and any modifiers you have specified.
        Referred to in your code as a reference to the
        array, $items.
        =item scratch
        Gives read-write access to the scratch variables, an
        anonymous hash. Referred to in your code as %scratch.
        =item config
        Gives read-write access to the configuration of the
        catalog. USE WITH EXTREME CAUTION -- many of the
        variables are references to anonymous arrays and
        hashes.  You can crash your catalog if you modify
        the wrong thing. Referred to in your code as $config,
        a reference to the hash containing the configuration
        structure.
        =item discount
        Gives read-write access to session discounts, an
        anonymous hash. Referred to in your code as %discounts.
        =item browser
        The browser string from the users browser, read-only. Referred
        to in your code as $browser.
        =item frames
        The true/false value determining whether frames
        processing is enabled. Read-only -- you can set
        the value with [frames-off] or [frames-on]. Referred
        to in your code as $frames.
        =item file
        If specified, the anchor text should be a file name
        to read the Perl code from.  This allows code to be maintained
        in separate files.  The file name is relative to the MiniVend
        base directory unless specified as an absolute path. 

</XMP>
<p>
<DT><STRONG>

<A NAME="tags_price_0">
[price code]</A>

</STRONG>
<DD>
Expands into the price of the product identified by code as
found in the products database.
<p>
<DT><STRONG>

<A NAME="tags_process_search_0">
[process_search]</A>

</STRONG>
<DD>
Calls the search with the proper URL, including MiniVend session tags.  Used
as the ACTION value for the search form.
<p>
<DT><STRONG>

<A NAME="tags_process_target_0">
[process_target frame]</A>

</STRONG>
<DD>
Calls the search with the proper URL, including MiniVend session tags.
Used as the ACTION value for the search form if the results are to be
targeted to a different window than the one set by SearchFrame (which is
``_self'' by default).
<p>
<DT><STRONG>

<A NAME="tags_quantity_name_0">
[quantity_name]</A>

</STRONG>
<DD>
Evaluates to the name to give an input box in which the
customer can enter the quantity to order.
<p>
<DT><STRONG>

<A NAME="tags_random_0">
[random]</A>

</STRONG>
<DD>
Selects from the predefined random messages, and is stripped if none
exist. See <EM>Controlling Page Appearance</EM>.
<p>
<DT><STRONG>

<A NAME="tags_row_1">
[row nn]</A>

</STRONG>
<DD>
Formats text in tables.  Intended for use in reports or &lt;PRE&gt;&lt;/PRE&gt; HTML
areas.  The parameter <EM>nn</EM> gives the number of columns to use. Inside the
row tag, [col param=value ...] tags may be used. 
<p>
<DT><STRONG>

<A NAME="tags_salestax_1">
[salestax]</A>

</STRONG>
<DD>
Expands into the sales tax on the subtotal of all the
items ordered so far. If there is no key field to derive the
proper percentage, such as state or zip code, it is set to whatever
the default is.  See <EM>Sales Tax</EM> for more information.
<p>
<DT><STRONG>

<A NAME="tags_search_list_1">
[search_list]</A>

</STRONG>
<DD>
Starts the representation of a search list. MiniVend tags can be
embedded in the search list, yielding a table or formatted
list of items with part number, description, price, and  hyperlinks to
order or go to its catalog page. 
<p>This is very similar to the [item-list] and on-the-fly page,
except that the code used is the first string in a series of
delimited fields in a record.  The return delimiter is normally
a TAB, but can be set to almost any value with mv_return_delim
or mv_index_delim.
<p>The interpreted tags include:
<p>
<DL COMPACT>
<DT><STRONG>

<A NAME="tags_if_data_1">
[if_data fieldname]</A>

</STRONG>
<DD>
If the arbitrary database field <EM>fieldname</EM> is non-blank, the following
text up to the [/if_data] tag is substituted. This can be used to
substitute IMG or other tags only if the corresponding source
item is present. Also accepts a [else]else text[/else] pair
for the opposite condition.
<p>
<DT><STRONG>

<A NAME="tags_if_field_1">
[if_field fieldname]</A>

</STRONG>
<DD>
If the product database field <EM>fieldname</EM> is non-blank, the following
text up to the [/if_field] tag is substituted. This can be used to
substitute IMG or other tags only if the corresponding source
item is present. Also accepts a [else]else text[/else] pair
for the opposite condition.
<p>
<DT><STRONG>

<A NAME="tags_item_code_0">
[item_code]</A>

</STRONG>
<DD>
Evaluates to the code for the current record -- it is the first parameter
returned in the search, if there are multiple fields.  You can set the
order of field return with <EM>mv_return_fields</EM>.
<p>
<DT><STRONG>

<A NAME="tags_item_data_0">
[item_data database fieldname]</A>

</STRONG>
<DD>
Evaluates to the field name <EM>fieldname</EM> in the arbitrary database
table <EM>database</EM>, for the current item.
<p>
<DT><STRONG>

<A NAME="tags_item_description_0">
[item_description]</A>

</STRONG>
<DD>
Evaluates to the product description (from the products file)
for the current item.
<p>
<DT><STRONG>

<A NAME="tags_item_field_0">
[item_field fieldname]</A>

</STRONG>
<DD>
Evaluates to the field name <EM>fieldname</EM> in the product database,  for
the current item.
<p>
<DT><STRONG>

<A NAME="tags_item_increment_0">
[item_increment]</A>

</STRONG>
<DD>
Evaluates to the number of the item in the match list. Used
for numbering search matches or order items in the list.
<p>
<DT><STRONG>

<A NAME="tags_item_link_0">
[item_link code]</A>

</STRONG>
<DD>
Expands into a hyperlink which will jump the user to a page
under the <EM>ItemLinkDir</EM> (default is the pages directory),
with anchor text as set in <EM>ItemLinkValue</EM> (default is ``More Details'').
If the page is not present, then <EM>flypage.html</EM> will be used to build
a page from the entry in the database.  If that doesn't work (perhaps
due to a missing flypage.html) then the error page <EM>notfound.html</EM> will
be displayed.
<p>
<DT><STRONG>

<A NAME="tags_item_price_0">
[item_price n*]</A>

</STRONG>
<DD>
Evaluates to the price for quantity <CODE>n</CODE> (from the products file)
of the current item.
<p>
</DL>
.
<p>
<DT><STRONG>

<A NAME="tags_selected_0">
[selected var_name value]</A>

</STRONG>
<DD>
This will output CHECKED if the variable <EM>var_name</EM> is equal to

<A HREF="tags.html#tags_value_0">value</A>
.  Not case sensitive.
<p>
<DT><STRONG>

<A NAME="tags_set_0">
[set variable]value[/set]</A>

</STRONG>
<DD>
Sets a scratchpad variable to 
<A HREF="tags.html#tags_value_0">value</A>
. One way this is used is to
save pages that a customer has seen -- perhaps for a rotating message.
A rotating message implementation is shown in the sample page <EM>flypage.html</EM>.
<p>The mv_* variables that are used for search and order conditionals are
in another namespace -- they can be set by means of hidden fields in a
form.
<p>
<DT><STRONG>

<A NAME="tags_shipping_description_0">
[shipping_description]</A>

</STRONG>
<DD>
The text description of the shipping mode currently selected.
<p>
<DT><STRONG>
<EM>[static /html/path] static-area [/static]</EM>
</STRONG>
<DD>
Defines an area (usually an item, loop, or search list) that
will be built with HREFs to regular pages instead of to the
MiniVend server. Search, scan, and order URLs will still be
made to go to the CGI.  Use in conjunction with <EM>Cookies</EM> and
<EM>StaticPath</EM> to allow access to static page trees from MiniVend.
This can increase system capacity on heavily-trafficked systems.
<p>
<DT><STRONG>

<A NAME="tags_subtotal_0">
[subtotal]</A>

</STRONG>
<DD>
Expands into the subtotal cost, exclusive of sales tax, of
all the items ordered so far.
<p>
<DT><STRONG>

<A NAME="tags_total_cost_0">
[total_cost]</A>

</STRONG>
<DD>
Expands into the total cost of all the items ordered so far, including
sales tax (if any).
<p>
<DT><STRONG>

<A NAME="tags_value_1">
[value field flag*]</A>

</STRONG>
<DD>
Expands into the current value of the customer input field
named by field. If <EM>flag</EM> is present, single and double
quotes will be escaped with a backslash; this allows reliable
SQL inserts.  See the section on input fields for more
information.
<p>
</DL>

</BODY>
</HTML>
