<div
    style="
            Position:Relative;
            Left:0; Top:0;
            Visibility:Visible;
            z-index:1;
	">
	<div 
		id=credit_card
		style="
				Position:Absolute;
				Left:0; Top:0;
				Visibility:Hidden;
				z-index:0;
		">
      <!--- credit card information --->
      <table cellspacing=0 cellpadding="0" width="100%">
      <tr>
        <td>
          <table border=0 cellspacing=0 cellpadding=4 width="100%">
          <tr>
            <td colspan="2" class="contentbar2" width="30%">
              <b>
              [error std_label="Credit Card Information" name=mv_credit_card_valid]
              </b>
            </td>
            <td class="contentbar2">
              [calc]
                my $accepted = $Variable->{CREDIT_CARDS_ACCEPTED};
                my (@out);
                my (@cc);
                my $out;
                push @cc, 'visa' if $accepted =~ /visa/;
                push @cc, 'mc' if $accepted =~ /mc/;
                push @cc, 'disc' if $accepted =~ /discover/;
                push @cc, 'amex' if $accepted =~ /amex/;
                for (@cc) {
                  push @out, qq{<IMG SRC="small$_.png">};
                }
                return join '&nbsp;&nbsp;', @out;
              [/calc]
            </td>
          </tr>
          <tr>
            <td align=right class="contentbar1" width="30%">
              <b>Card Number: </b>
            </td>
            <td colspan=2 class="contentbar1">
              <b><INPUT TYPE=text NAME=mv_credit_card_number SIZE=22></b>
            </td>
          </tr>
		  [if variable MV_DEMO_MODE]
		  <tr>
		  	<td class=contentbar1>
			</td>
		  	<td colspan=2 class=contentbar1>
              (test number <A HREF="javascript:void 0" onclick="checkout.mv_credit_card_number.value='4111 1111 1111 1111'; return false;">4111 1111 1111 1111</A>)
			</td>
		  </tr>
		  [/if]
          <tr>
            <td align=right class="contentbar1">
              <b>Expiration: </b>
            </td>
            <td colspan=2 class="contentbar1">

                <SELECT NAME=mv_credit_card_exp_month>
                [loop
                        option=mv_credit_card_exp_month
						acclist=1
                        list=|
1=01 - January,
2=02 - February,
3=03 - March,
4=04 - April,
5=05 - May,
6=06 - June,
7=07 - July,
8=08 - August,
9=09 - September,
10=10 - October,
11=11 - November,
12=12 - December|]
                <OPTION VALUE="[loop-code]"> [loop-param label]
                [/loop]
                </SELECT>
        
                <SELECT NAME=mv_credit_card_exp_year>
                [comment]
                This should always return the current year as the first, then
                7 more years.
                [/comment]
                [loop option=mv_credit_card_exp_year lr=1 list=`
                my $year = $Tag->time( '', { format => '%Y' }, '%Y' );
                my $out = '';
                for ($year .. $year + 7) {
                        /\d\d(\d\d)/;
                        $last_two = $1;
                        $out .= "$last_two\t$_\n";
                }
                return $out;
                `]

                <OPTION VALUE="[loop-code]"> [loop-pos 1]
                [/loop]
                </SELECT>
              </td>
            </tr>
            </table>
                                                
          </td>
        </tr>
        </table>
	</div>
	<div 
		id=postal
		style="
				Position:Absolute;
				Left:0; Top:0;
				Visibility:Hidden;
				z-index:0;
		">
		We will wait for a check sent to us referencing the order number you receive on your receipt.
        </div>
	<div 
		id=cod
		style="
				Position:Absolute;
				Left:0; Top:0;
				Visibility:Hidden;
				z-index:0;
		">
		There will be a [handling cod] charge added for COD.
        </div>
        
	<div 
		id=online_check
		style="
				Position:Absolute;
				Left:0; Top:0;
				Visibility:Hidden;
				z-index:0;
		">
        <table border="0" cellspacing="0" cellpadding="0" width="100%">
        <tr>
          <td>
            <table border="0" cellspacing="0" cellpadding="0"  width="100%">
            <tr>
              <td class="contentbar2" colspan="2" width="30%">
                <b>&nbsp;&nbsp;Check Information</b>
              </td>
              <td class="contentbar2">&nbsp;</td>
              <td class="contentbar2">&nbsp;</td>
            </tr>
            <tr>
              <td align="right" class="contentbar1">
                [error name=check_acct std_label="Account Number" required=1]
              </td>
              <td colspan="3 align="left" class="contentbar1">
                <b>
                <INPUT TYPE=text NAME=check_acct SIZE=22 value="[value check_acct]">
                </b>
              </td>
            </tr>
            <tr>
              <td align="right" class="contentbar1">
                [error name=check_route std_label="Routing Number" required=1]
                
              </td>
              <td align="left" colspan="3" class="contentbar1">
                <b><INPUT TYPE=text NAME=check_route SIZE=22 value="[value check_route]"></b>
              </td>
            </tr>
            <tr>
              <td align="right" class="contentbar1">
                [error name=check_num std_label="Check Number" required=1]
              </td>
              <td align="left" colspan="3" class="contentbar1">
                <b>
                <INPUT TYPE=text NAME=check_num SIZE=22 value="[value check_num]">
                </b>
              </td>
                </tr>
            <tr>
              <td align="right" class="contentbar1">
                [error name=check_bank_phone std_label="Bank Phone" required=1]
                
              </td>
              <td align="left" colspan="3" class="contentbar1">
                <b>
                <INPUT TYPE=text NAME=check_bank_phone SIZE=22 value="[value check_bank_phone]">
                </b>
              </td>
                </tr>
			<tr>
				<td colspan=4 class=contentbar1>&nbsp;</td>
			</tr>
		  </table>
		</td>
	  </tr>
	</table>
	</div>
	<div 
		id=purchase_order
		style="
				Position:Absolute;
				Left:0; Top:0;
				Visibility:Visible;
				z-index:0;
		">
 
        <table cellspacing="0" cellpadding="0" width="100%">
        <tr>
          <td>
            <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr class="contentbar2">
              <td class="contentbar2" colspan="2">
                <b> P.O. Information </b>
              </td>
              <td colspan=2 class="contentbar2">&nbsp;</td>
            </tr>
            <tr>
              <td align=right class="contentbar1" width="30%">
                [error name=credit_limit_ok std_label="PO Number" required=1] &nbsp; &nbsp;
              </td>
              <td align=left colspan=3 class="contentbar1">
                <b>
                <INPUT NAME=project_id VALUE="[value project_id]" SIZE=14>
                </b>
              </td>
            </tr>
			<tr>
				<td colspan=4 class=contentbar1>&nbsp;</td>
			</tr>
        
            [if type=data
                term="userdb::credit_limit::[data session username]"
                op=">"
                compare=0.01]
        
            <tr>
              <td align=right valign=top class=contentbar1>
                <b> Available credit </b>&nbsp;&nbsp;&nbsp;
              </td>
              <td align=left colspan=3 class=contentbar1>
                [currency]
                [data table=userdb col=credit_limit key="[data session username]"]
                [/currency]
                
                [if type=data
                        term="userdb::credit_limit::[data session username]"
                        op=<
                        compare="[total-cost noformat=1]"
                ]
                <BR>
                Order total [total-cost] exceeds credit limit, please call.
                [/if]
                <BR>
              </td>
            </tr>
        
            [/if]
			<tr>
				<td colspan=4 class=contentbar1>&nbsp;</td>
			</tr>
            </table>
                                                
          </td>
        </tr>
        </table>
	</div>
</div>

<script>
	visible('[either][value mv_order_profile][or]credit_card[/either]');
</script>
