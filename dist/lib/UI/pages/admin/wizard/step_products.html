[set page_title]Upload Products[/set]
[set ui_checklist]1[/set]
[set help_name]wizard.batchupload[/set]
@_UI_STD_HEAD_@

<table><tr><td width=500>
[calc]
	my $readstatus = q{[version extended=1 modtest="Spreadsheet::ParseExcel"]};
	my $writestatus= q{[version extended=1 modtest="Spreadsheet::WriteExcel"]};
	return if $readstatus && $writestatus;
	my @mod;
	push @mod, "Spreadsheet::WriteExcel" unless $writestatus;
	push @mod, "Spreadsheet::ParseExcel" unless $readstatus;
	my $miss = join "<BR>", @mod;
	push @inst, "perl -MCPAN -e 'install Spreadsheet::ParseExcel'"
		unless $readstatus;
	push @inst, "perl -MCPAN -e 'install Spreadsheet::WriteExcel'"
		unless $writestatus;
	my $inst = join "<BR>", @inst;
	my $out = <<EOF;
<H2>XLS product upload will not work properly.</H2>
Please install needed Perl modules:
<small>
<blockquote>
	<FONT COLOR="__UI_C_CONTRAST__">$miss</FONT>
</blockquote>
</small>
The easiest way to do this is to use the CPAN module and do:
<blockquote>
$inst
</blockquote>

EOF
	return $out;
[/calc]
This section allows you to enter your products. To use the Interchange spreadsheet:<br>
<ol>
<li>Download the Interchange Spreadsheet Template
<a href="__IMAGE_DIR__/template.xls">template.xls</a>.
<li>Or download one of our spreadsheets preloaded with sample products:
	<UL>
	<LI><a href="__IMAGE_DIR__/construct.xls">Hardware & Construction Tools</A>
	<LI><a href="__IMAGE_DIR__/reports.xls">Marketing Reports</A>
	</UL>
<li>Add your products to the spreadsheet and click <b>Save</b>.
<li>Click <b>Browse</b>. Find the location where you saved products.xls and
click <b>Next</b> to upload the populated spreadsheet.
</ol>
</td></tr></table>

[table-editor 
	table=variable
	left_width=120
	table_width="500"
	wizard=1
	defaults=1
	bottom_buttons=1
	no_top=1
	no_bottom=1
   	row_template="[scratch row_template]"

	mv_nextpage="[either][cgi ui_nextpage][or]__UI_BASE__/wizard/step_preview[/either]"
	mv_prevpage="[either][cgi ui_prevpage][or]__UI_BASE__/wizard/step_about[/either]"
	hidden.ui_return_to="__UI_BASE__/wizard/index"

	file_upload=1

	ui_data_key=code
	default.code="[value code]"
	help.code="If this is the first time you have used this definition, you will need to assign a nickname. Only A-Z0-9 are valid."
	label.code="Catalog Identifier"
	widget.code=text_10

	ui_data_fields="code products"
	ui_display_only="products"
	ui_hide_key=1

	label.products="Products"
	help.products="Select the Excel-format file you entered your products list into (optional)."
	widget.products=uploadhelper
	outboard.products=upload
]

@_UI_STD_FOOTER_@
