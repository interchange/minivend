[tmp passuser][either][cgi username][or][cgi user_id][/either][/tmp]
[calc]
	$CGI->{no_dbmenu} = 1;
	$CGI->{access_menu} = 1;
	return;
[/calc]
[seti page_title]Change password: [scratch passuser][/seti]
[seti page_banner]Change password: <b>[scratch passuser]</b>[/seti]
[set ui_class]Admin[/set]
[set page_perm]access=e[/set]
[set help_name]change.password[/set]
[set icon_name]icon_config.gif[/set]
[tmp old_needed]1[/tmp]
[if-mm super]
	[calc]
		# Note that the final authority on whether the old password is needed
		# is &Vend::UserDB::change_pass -- this logic is for widget display only.
		$Scratch->{old_needed} = 0 if $CGI->{user_id} ne $Session->{username};
		return;
	[/calc]
[/if-mm]
@_UI_STD_HEAD_@

[if session failure]
<P>
&nbsp;
<BLOCKQUOTE>
<FONT COLOR=RED>[L]Failure:[/L]</FONT> [data session failure][data base=session field=failure value=""]
</BLOCKQUOTE>
<P>
&nbsp;
[/if]

[if scratch ui_message]
<P>
<BLOCKQUOTE>
	[scratch ui_message][set ui_message][/set]
</BLOCKQUOTE>
<P>
&nbsp;
[/if]

<FORM ACTION="[process]" METHOD=POST>
<INPUT TYPE=hidden NAME=mv_todo     VALUE=back>
<INPUT TYPE=hidden NAME=mv_nextpage VALUE=__UI_BASE__/access>
<INPUT TYPE=hidden NAME=mv_failpage VALUE=@@MV_PAGE@@>
<INPUT TYPE=hidden NAME=mv_username VALUE="[scratch passuser]">
<INPUT TYPE=hidden NAME=user_id     VALUE="[scratch passuser]">

<table __UI_T_PROPERTIES__>

<tr>
<td colspan=2 bgcolor=__UI_C_TOPBLOCKBAR__><img src="bg.gif" width=__UI_MAIN_WIDTH__ height=1></td>
</tr>

<tr>
<td bgcolor=__UI_C_INTBLOCK__ align=right>
<small>User name</small>
</td>
<td bgcolor=__UI_C_INTBLOCK__>
[scratch passuser]
</td>
</tr>

[if scratch old_needed]
<tr>
<td bgcolor=__UI_C_INTBLOCK__ align=right>
<small>Old password</small>
</td>
<td bgcolor=__UI_C_INTBLOCK__>
<INPUT TYPE=password NAME=mv_password_old VALUE="" SIZE=12>
</td>
</tr>
[/if]

<tr>
<td bgcolor=__UI_C_INTBLOCK__ align=right>
<small>New password</small>
</td>
<td bgcolor=__UI_C_INTBLOCK__>
<INPUT TYPE=password NAME=mv_password VALUE="" SIZE=12>
</td>
</tr>

<tr>
<td bgcolor=__UI_C_INTBLOCK__ align=right>
<small>Verify password</small>
</td>
<td bgcolor=__UI_C_INTBLOCK__>
<INPUT TYPE=password NAME=mv_verify VALUE="" SIZE=12>
</td>
</tr>

<tr>
<td colspan=2 bgcolor=__UI_C_TOPBLOCKBAR__><img src="bg.gif" width=__UI_MAIN_WIDTH__ height=1></td>
</tr>

</TABLE>

[if-mm advanced access=e]
	[button text="[if scratch old_needed]Change[else]Set Password[/else][/if]"]
		mv_todo=set
		mv_click=MMChange
	[/button]
	[button text=Permissions]
		mv_todo=set
		mv_click=MMChange
		mv_nextpage=__UI_BASE__/access_permissions
	[/button]
	[button text=Cancel]
	[/button]
[else]
	[button text=Back]
	[/button]
[/else]
[/if-mm]

</FORM>

@_UI_STD_FOOTER_@

<!-- page: @@MV_PAGE@@ -->
