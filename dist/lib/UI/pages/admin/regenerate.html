[set page_title][L]Static site generation[/L][/set]
[set page_banner][L]Static site generation[/L][/set]
[set page_perm]regen[/set]
[set help_name]regen.main[/set]
[set ui_class]Design[/set]
[set icon_name]icon_config.gif[/set]

<!-- ----- BEGIN REAL STUFF ----- -->

@_UI_STD_HEAD_@
<!-- ----- BEGIN REAL STUFF ----- -->
<form action="[area __UI_BASE__/regen]" method="GET">
<INPUT TYPE=hidden NAME=mv_nextpage VALUE="__UI_BASE__/regen">

<table __UI_T_PROPERTIES__>
<tr>
<td colspan=2 class=rborder><img src="bg.gif" width=__UI_MAIN_WIDTH__ height=1></td>
</tr>
<tr>
<td class=rnorm width="__UI_LEFT_WIDTH__" valign=top>

<input type="submit" value="[L]Regenerate[/L]"><BR><BR>
<input type=checkbox name=ui_build_verbose> [L]Verbose[/L]<br>
<select NAME=ui_max_build>
<option VALUE=100>100
<option VALUE=200>200
<option VALUE=500 selected>500
<option VALUE=1000>1,000
<option VALUE=2000>2,000
<option VALUE=5000>5,000
<option VALUE=10000>10,000
</select>
</td>
<td class=rnorm width="__UI_RIGHT_WIDTH__">

[tmp pages][/tmp]

[calc]
    if ($Config->{StaticAll}) {
        # startpage makes sense only if "StaticAll" is set
    	$Values->{ui_initial_page} = $Config->{StaticIndex} || $Config->{SpecialPage}{catalog};
        %forced_pages = ();
    } else {
    	$Values->{ui_initial_page};
        # setup hash with selected pages
        %forced_pages = %{$Config->{StaticPage}};
        if ($Config->{StaticFly}) {
            $forced_pages{$Config->{Special}->{flypage}} = 1;
        }
    }

    # Find the list of pages not defined "NoCache"
	@pages = split /\s+/, $Tag->list_pages();
	my $check = $Config->{NoCache};
	for(@pages) {
		my $test = $_;
		do {
			$_ = '' if defined $check->{$test};
		} while ($test =~ s:(.*)/.*:$1:);
	}
	@pages = grep length($_), @pages;
	$Scratch->{pages} = join "\n", grep $_, @pages;

    # Generated selection of forced pages
    my ($opts, $selected);
    for (@pages) {
        if (defined $forced_pages{$_}) {
            $selected = ' selected';
        } else {
            $selected = '';
        }
        $opts .= "<option$selected>$_\n";
    }
	$Scratch->{forced_pages} = $opts;
	return;
[/calc]

[if config StaticAll]
<b>[L]Entry page:[/L]</b><br>


<select name="ui_initial_page">
[loop option=ui_initial_page list="[scratch pages]"]
	<option>[loop-code]
[/loop]
</select><BR><BR>
[/if]
	<table>
		<tr>
			<td>
			<b>[L]Force build of:[/L]</b><br>
			<select name="ui_force_build" multiple size=25>
			[scratchd forced_pages]  
			</select>
			</td>
			<td>

			<b>[L]Never build:[/L]</b><br>
			<select name="ui_never_build" multiple size=25>
			[loop prefix=never list="[scratch pages]"]
				<option>[never-code]
			[/loop]
			</select>
			</td>
		</tr>
	</table>
</td>
</tr>

<tr>
<td colspan=2 class=rborder><img src="bg.gif" width=__UI_MAIN_WIDTH__ height=1></td>
</tr>

</table>

</form>


<!-- ----- END REAL STUFF ----- -->

@_UI_STD_FOOTER_@
<!-- page: @@MV_PAGE@@ -->
