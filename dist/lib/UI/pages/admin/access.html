[set page_title]Administrator Accounts[/set]
[set page_perm]access=l[/set]
[set help_name]access.main[/set]
[set icon_name]admin/icon_config.gif[/set]

@_UI_STD_HEAD_@
[if scratch ui_message]
<P>
<BLOCKQUOTE>
	[scratch ui_message][set ui_message][/set]
</BLOCKQUOTE>
<P>
&nbsp;
[/if]


<form action="[area ui]" method=POST name=accessform>
<farm action="/cgi-bin/test-cgi" name=accessform>
<INPUT TYPE=hidden NAME=mv_todo VALUE=back>
<INPUT TYPE=hidden NAME=mv_nextpage VALUE="__UI_BASE__/user_edit">
<INPUT TYPE=hidden NAME=ui_hide_key VALUE="1">

<style type="text/css">
<!--
 td{font-family:arial, helvetica, sans-serif}
   -->
</style>

<center>
<table __UI_T_PROPERTIES__>
<tr>
<td colspan=2 bgcolor=__UI_C_TOPBLOCKBAR__><img src="images/cleardot.gif" width=__UI_MAIN_WIDTH__ height=1></td>
</tr>
[if-mm advanced access=c]

<tr>
<td colspan=2 bgcolor="__UI_C_INTBLOCK__">

[button text="Create new administrator" src="admin/create.gif"]
mv_nextpage=__UI_BASE__/user_edit
user_id=NEW
ui_hide_key=0
[/button]

</td>
</tr>

<tr>
<td colspan=2 bgcolor=__UI_C_TOPBLOCKBAR__><img src="images/cleardot.gif" width=__UI_MAIN_WIDTH__ height=1></td>
</tr>
[/if-mm]

<tr>
<td bgcolor="__UI_C_INTBLOCK__" width=__UI_LEFT_WIDTH__>

[if-mm advanced access=e]
	[button name=mv_junk value="Edit administrator" src="admin/edit.gif"][/button]<p>
[/if-mm]

[if-mm advanced perm=v]
[button value="Show permissions" src="admin/show.gif"]
mv_nextpage=__UI_BASE__/access_permissions
ui_return_to=@@MV_PAGE@@
[/button]<p>
[/if-mm]

[if-mm advanced access=e]
[button value="Change password" src="admin/change_password.gif"]
mv_nextpage=__UI_BASE__/user_change_pass
ui_hide_key=0
[/button]
<p>[/if-mm]

[if-mm advanced access=d]
[button text="Delete administrator"
		form=accessform
		confirm="Are you sure you want to delete this administrator?"
		src="admin/delete.gif"]
mv_todo=return
mv_nextpage=@@MV_PAGE@@
[flag type=write table="__UI_ACCESS_TABLE__"]
[perl table="__UI_ACCESS_TABLE__"]
	my $db = $Db{__UI_ACCESS_TABLE__};
	if(! $db) {
		$Scratch->{ui_message} = "Bad access table __UI_ACCESS_TABLE__";
		return;
	}
	unless ( $db->delete_record($CGI->{user_id}) ) {
		$Scratch->{ui_message} =
			"Failed to delete administrator $CGI->{user_id} from table __UI_ACCESS_TABLE__";
		return;
	}
	$Scratch->{ui_message} =
			"Deleted administrator $CGI->{user_id} from table __UI_ACCESS_TABLE__";
	return;
[/perl]
[/button]
[/if-mm]

</td>

<td bgcolor="__UI_C_INTBLOCK__" width=__UI_RIGHT_WIDTH__>
<select name="user_id" size=10>
[loop search="
		fi=access
		st=db
		co=yes
		sf=username
		se=:
		bs=yes
		ne=1
		tf=name
	"]
  <option value="[loop-code]">[loop-code] -- [loop-data access name][if-loop-data access super]*[/if-loop-data]
[/loop]
</select>&nbsp;<B>* superuser</B>
</td>
</tr>

<tr>
<td colspan=2 bgcolor=__UI_C_TOPBLOCKBAR__><img src="images/cleardot.gif" width=__UI_MAIN_WIDTH__ height=1></td>
</tr>

</table>

<p>

[button text="Back"]
mv_todo=back
mv_nextpage=index
[/button]

</form>

@_UI_STD_FOOTER_@

<!-- page: @@MV_PAGE@@ -->
