[set page_perm]files[/set]
[set page_title]Configuration[/set]
[set ui_class]Admin[/set]
[set help_name]genconfig.main[/set]
[set icon_name]admin/icon_config.gif[/set]
@_UI_STD_HEAD_@

<!-- ----- BEGIN REAL STUFF ----- -->

<center>
<TABLE width="90%" border=0 callpadding=0 cellspacing=0>
<tr bgcolor="#000000" height=1><td></td></tr>
<TR BGCOLOR="#__UI_C_TOPBLOCKBAR__">
<TD VALIGN="top" width="20%">
<FONT COLOR="__UI_C_TITLEBARTXT__">
Database tables
</font>
</td></tr>
<tr bgcolor="#000000" height=1><td></td></tr>
<tr bgcolor="#FFFFFF" height=2><td></td></tr>


<tr><td align=left bgcolor=__UI_C_INTBLOCK__>

<table border=0 cellspacing=0 cellmargin=0 cellpadding=0>
[loop list="[list-databases]"]
[loop-sub db_action]
sub {
#Log("args=" . $Tag->uneval({ ref => \@_ }));
	my $name = shift;
	my $rec = shift;
	my $tab = $rec->[0];
#Log("name=$name tab=$tab");
	$name = $tab if ! $name;
	my $url = "$Config->{VendURL}/__UI_BASE__";
	my $froot = sub {
		my $fn = shift;
		$fn =~ s#^$Config->{VendRoot}/##o;
		return $fn;
	};
	my $ref = {
		upload => { 
						img => 'admin/up.gif',
						url => "$url/upload_file?mv_arg=" .
								$froot->(join "/",
											($Config->{Database}{$tab}{dir} || $Config->{ProductDir}),
											$Config->{Database}{$tab}{file}
										)
								. '&ui_return_to=@@MV_PAGE@@',
					},
		view => { 
						img => 'admin/index.gif',
						url => "$url/do_view?mv_arg=" .
								$froot->(join "/",
											($Config->{Database}{$tab}{dir} || $Config->{ProductDir}),
											$Config->{Database}{$tab}{file}
										),
					},
		download => { 
						img => 'admin/down.gif',
						url => "$Config->{VendURL}/ui_download/" .
								$froot->(join "/",
											($Config->{Database}{$tab}{dir} || $Config->{ProductDir}),
											$Config->{Database}{$tab}{file}
										),
					},
		import => { 
						img => 'admin/left.gif',
						url => "$url/import_table?mv_data_table=$tab",
					},
		export => { 
						img => 'admin/right.gif',
						url => "$url/export_table?mv_data_table=$tab",
					},
		edit => { 
						img => 'admin/layout.gif',
						url => "$url/flex_select?mv_data_table=$tab",
					},
	};
	my $out = '';
	if(! $dblist_done_one++) {
		$out .= '<tr>';
		for(qw/edit import export view upload download /, "Table name (description)") {  # Add "report"
			$out .= qq{<td bgcolor="__UI_C_TITLEBARBG__" align=center><font size="-1" color="__UI_C_TITLEBARTXT__">$_</td>};
		}
		$out .= "</tr>";
	}
	$out .= '<tr>';
	for(qw/edit import export view upload download /) {  # Add "report"
		my $line = $ref->{$_};
		$out .= <<EOF;
<td ALIGN=center><A HREF="$line->{url}"><img src="$line->{img}" border=0 alt="$_ $tab" align=top></A></td>
EOF
	}
	return $out . qq{<td>&nbsp;<FONT SIZE="+1">$name</FONT></td></tr>};
}
[/loop-sub]
[loop-exec db_action][loop-data __UI_META_TABLE__ label][/loop-exec]
[/loop]
</table>

</td></tr>

<tr bgcolor="#000000" height=1><td></td></tr>

</table>
</center>


<!-- ----- END REAL STUFF ----- -->

@_UI_STD_FOOTER_@
<!-- page: @@MV_PAGE@@ -->
