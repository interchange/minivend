[set page_perm]page[/set]
[set ui_class]Content[/set]
[set help_name]page.editor[/set]
[set icon_name]icon_pages.gif[/set]
[seti page_title]Edit [cgi ui_type] [cgi ui_name][/seti]
[seti page_banner]Edit [cgi ui_type] <i>[cgi ui_name]<i>[/seti]

[comment]This modifies content when regular CGI submit is used[/comment]
[if cgi ui_content_op]
	[tmp ce_status][content-modify][/tmp]
[/if]

[comment]
	This modifies content when silent process is used, set also in
	ContentEditor.pm
[/comment]
[set ce_modify][content-modify][/set]

@_UI_STD_HEAD_@

<!-- [pragma safe_data] -->

[comment]
	These files are kept in lib/UI/pages/include so that
	there will be little chance of a parsing error.

		Include files: lib/UI/pages/include/*_editor

	They can be relocated to a catalog-specific place
	by copying to CATROOT/include.
[/comment]
[if cgi new]
<form action="[area __UI_BASE__/content_editor]">
<table width="60%">
<tr>
	<td style="font-weight: bolder; text-align: right">
		[calc] return "\u$CGI->{ui_type}"; [/calc] name
	</td>
	<td>
		[set page_name_click]
			[calc]
				$CGI->{ui_name} =~ s/^\s+//;
				$CGI->{ui_name} =~ s/\s+$//;
				$CGI->{ui_name} = $Tag->filter({
													op => 'filesafe',
													body => $CGI->{ui_name},
												});
				my $pat = quotemeta $Config->{HTMLsuffix};
		#Debug("pat=$pat");
				$pat = qr/$pat$/;
		#Debug("pat=$pat");
				$CGI->{ui_name} .= $Config->{HTMLsuffix}
					unless $CGI->{ui_name} =~ $pat;
		#Debug("page=$CGI->{ui_name}");
				return;
			[/calc]
		[/set]
		<input type=text   name="ui_name" size=30>
		<input type=hidden name="mv_action" value="back">
		<input type=hidden name="mv_click" value="page_name_click">
		<input type=hidden name="ui_type" value="[cgi ui_type]">
		<input type=hidden name="ui_return_to" value="[cgi ui_return_to]">
	</td>
</tr>
	[if cgi ui_type eq page]
<tr>
	<td style="font-weight: bolder; text-align: right">
		Template type:
	</td>
	<td>
			 [display
							name=ui_page_template
							type=select
							default="[page-param ui_page_template]"
							passed="[content-info templates=1]"
							]
	</td>
</tr>
	[/if]
<tr>
	<td> &nbsp; </td>
	<td>
		<input type=submit value="[L]Create new page[/L]">
	</td>
</tr>
</table>
</form>
[elsif cgi ui_type eq component]
	[include include/component_editor]
[/elsif]
[elsif cgi ui_type eq template]
	[include include/template_editor]
[/elsif]
[else]
	[set page_name_click][/set]
	[include include/page_editor]
[/else]
[/if]

@_UI_STD_FOOTER_@
