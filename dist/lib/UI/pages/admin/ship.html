[set help_name]shipping.create[/set]
[set page_title]Shipping options: create method[/set]
[set icon_name]admin/icon_config.gif[/set]
@@UI_STD_HEAD@@
<!-- 
	read=[calc]
			delete $Config->{Shipping_line};
			delete $Config->{Shipping_desc};
			return;
			[/calc][read-shipping]
[if cgi ui_ship_action eq delete]
    ## delete method ##
	update=[calc]
		my $count;
		my @out;
		my $mode = $CGI->{ui_shipmode};
		delete $Config->{Shipping_desc}{$mode};
		for(@{$Config->{Shipping_line}}) {
			$count++;
			next if $_->[0] eq $mode;
			push @out, $_;
		}
		$left = scalar @out;
		$Config->{Shipping_line} = \@out;
		return sprintf("deleted %d lines, saved %s lines", $count - $left, $left);
	[/calc]
	write=[write-shipping]
[/if]
	-->

<!-- ----- BEGIN REAL STUFF ----- -->

<p>
<form action="[process]" method=POST>
<input type=hidden name=mv_todo value=return>

<table cellpadding=3 cellspacing=0>

<tr>
<td colspan=2 bgcolor=__UI_C_TOPBLOCKBAR__><img src="cleardot.gif" width=__UI_OVERALL_WIDTH__ height=1></td>
</tr>

[set Create new method]
mv_nextpage=__UI_BASE__/ship_edit
ui_shipmode=new
ui_header=Create method
[/set]

<tr>
<td colspan=2 bgcolor="__UI_C_INTBLOCK__" width=__UI_LEFT_WIDTH__>
<input type=submit name="mv_click" value="Create new method">
</td>
</tr>

<tr>
<td colspan=2 bgcolor=__UI_C_TOPBLOCKBAR__><img src="cleardot.gif" width=__UI_OVERALL_WIDTH__ height=1></td>
</tr>

<tr>
<td bgcolor="__UI_C_INTBLOCK__" width=__UI_LEFT_WIDTH__>

[set Edit method]
mv_nextpage=__UI_BASE__/ship_edit
ui_header=Edit <I>[cgi ui_shipmode]</I> method
[/set]

<input type=submit name="mv_click" value="Edit method">
<br>
[set Edit data table]
mv_nextpage=__UI_BASE__/ship_data
ui_header=Edit <I>[cgi ui_shipmode]</I> data table
[/set]
<input type=submit name="mv_click" value="Edit data table">
<br>

[set Delete method]
mv_nextpage=@@MV_PAGE@@
ui_ship_action=delete
[/set]

<input type=submit name="mv_click" value="Delete method"
 onClick="return confirm('Are you sure you want to delete this method?')">
<p>

[set Back]
[if scratch ui_return_menu]
mv_nextpage=[scratch ui_return_menu]
[else]
mv_nextpage=admin/configure
[/else]
[/if]
[/set]

<input type=submit name="mv_click" value="Back">
</td>

<!-- Read the current shipping def, success=[read-shipping] -->

<td bgcolor="__UI_C_INTBLOCK__" width=__UI_RIGHT_WIDTH__>
<select name=ui_shipmode size=10>
[perl]
	@modes = sort keys %{$Config->{Shipping_desc}};
	my $max = 0;
	for (@modes) {
		$max = length($_) if length($_) > $max;
	}
	$max += 2;
	for (@modes) {
		push @out, sprintf(qq{<OPTION VALUE="$_">%s: %s</OPTION>}, $_, $Config->{Shipping_desc}{$_}); 
	}
	return (join "\n", @out);
[/perl]
</select>
</PRE>
</td></tr>

<tr>
<td colspan=2 bgcolor=__UI_C_TOPBLOCKBAR__><img src="cleardot.gif" width=__UI_OVERALL_WIDTH__ height=1></td>
</tr>

</table>
</form>


<!-- ----- END REAL STUFF ----- -->

@@UI_STD_FOOTER@@
<!-- page: @@MV_PAGE@@ -->
