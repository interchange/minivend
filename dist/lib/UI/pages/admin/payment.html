[flag type=write table=variable]
[set page_title]Payment Options[/set]
[set ui_class]Admin[/set]
[set help_name]payment.main[/set]
[set icon_name]icon_config.gif[/set]
@_UI_STD_HEAD_@

<!-- ----- BEGIN REAL STUFF ----- -->

<!-- ----- BEGIN REAL STUFF ----- -->
[perl tables=variable]
	delete $Scratch->{change_payment};
	return unless $CGI->{change_payment} eq 'do';
	$Scratch->{change_payment} = 1;
	for (my $i = 1; $i < 1000; $i++) {
		last unless defined $CGI->{"cc_accepted$i"};
		push @cc, $CGI->{"cc_accepted$i"};
	}
	$Scratch->{CREDIT_CARDS_ACCEPTED} = join " ", @cc;
	$Scratch->{PO_ACCEPTED} = $CGI->{po};
	$Scratch->{COD_ACCEPTED} = $CGI->{cod};
	$Scratch->{POSTAL_ACCEPTED} = $CGI->{postal};
	$Scratch->{CHECK_ACCEPTED} = $CGI->{check};
	return;
[/perl]
[if scratch change_payment]
[loop list="CREDIT_CARDS_ACCEPTED PO_ACCEPTED COD_ACCEPTED CHECK_ACCEPTED POSTAL_ACCEPTED"]
	<!-- [loop-code]: [data table=variable
						col=Variable
						key=[loop-code]
						value="[scratch [loop-code]]"] -->
[/loop]
<!-- exporting: [export variable] -->
[/if]

[if type=explicit
	compare=|
			[newer
				source=__UI_PRODUCT_DIR__/variable.txt
				target=`"$Config->{ConfDir}/status.$Config->{CatalogName}"`
				]
			|]
[value name=ui_changes_made set=1 hide=1]
<FONT COLOR="__CONTRAST__">You need to [page __UI_BASE__/reconfig @@MV_PAGE@@]apply changes[/page] for changes to take effect.</FONT>
[/if]

[calc]
		@cc = grep /\S/, split /\s+/,
						tag_data(qw/variable Variable CREDIT_CARDS_ACCEPTED/);
		for (qw/PO_ACCEPTED COD_ACCEPTED CHECK_ACCEPTED POSTAL_ACCEPTED/) {
			$Scratch->{$_} = tag_data(qw/variable Variable/, $_);
		}
		for (@cc) {
			$cc{$_} = 1;
		}
		$Scratch->{its} = <<EOF;
visa	VISA	$cc{visa}
mc	Mastercard	$cc{mc}
discover	Discover	$cc{discover}
amex	American Express	$cc{amex}
other	Diners Club/Other	$cc{other}
EOF
		return;
[/calc]
<form action="[area @@MV_PAGE@@]" method=POST>
<INPUT TYPE=hidden NAME=change_payment VALUE=do>

<table __UI_T_PROPERTIES__>
<tr>
<td colspan=2 bgcolor=__UI_C_TOPBLOCKBAR__><img src="bg.gif" width=__UI_MAIN_WIDTH__ height=1></td>
</tr>

<tr>
<td bgcolor=__UI_C_INTBLOCK__><b>Name</b></td>
<td bgcolor=__UI_C_INTBLOCK__><b>Accepted</b></td>
</tr>

[loop list="[scratch its]" lr=1]
<tr>

<td bgcolor=__UI_C_INTBLOCK__>
[loop-pos 1]
</td>

<td bgcolor=__UI_C_INTBLOCK__>

<select name="cc_accepted[loop-increment]">
<option value=""> Not Accepted
<option value="[loop-code]" [if-loop-pos 2]SELECTED[/if-loop-pos]> Accepted
</select>

</td>
</tr>
[/loop]

<tr>

<td bgcolor=__UI_C_INTBLOCK__>
Online Check
</td>

<td bgcolor=__UI_C_INTBLOCK__>

<select name="check">
<option value="0"> Not Accepted
<option value="1" [if scratch CHECK_ACCEPTED]SELECTED[/if]> Accepted
</select>

</td>

</tr>

<tr>

<td bgcolor=__UI_C_INTBLOCK__>
COD
</td>

<td bgcolor=__UI_C_INTBLOCK__>

<select name="cod">
<option value="0"> Not Accepted
<option value="1" [if scratch COD_ACCEPTED]SELECTED[/if]> Accepted
</select>

</td>

</tr>


<tr>

<td bgcolor=__UI_C_INTBLOCK__>
Postal billing
</td>

<td bgcolor=__UI_C_INTBLOCK__>

<select name="postal">
<option value="0"> Not Accepted
<option value="1" [if scratch POSTAL_ACCEPTED]SELECTED[/if]> Accepted
</select>

</td>

</tr>

<tr>

<td bgcolor=__UI_C_INTBLOCK__>
Purchase Order
</td>

<td bgcolor=__UI_C_INTBLOCK__>

<select name="po">
<option value="0"> Not Accepted
<option value="1" [if scratch PO_ACCEPTED]SELECTED[/if]> Accepted
</select>

</td>

</tr>
<tr>
<td colspan=2 bgcolor=__UI_C_TOPBLOCKBAR__><img src="bg.gif" width=__UI_MAIN_WIDTH__ height=1></td>
</tr>

</table>
[loop list="CREDIT_CARDS_ACCEPTED PO_ACCEPTED COD_ACCEPTED CHECK_ACCEPTED POSTAL_ACCEPTED"]
	[set [loop-code]][/set]
[/loop]

<p>

<input type=submit name="update" value="Update">

</form>


<!-- ----- END REAL STUFF ----- -->

@_UI_STD_FOOTER_@
<!-- page: @@MV_PAGE@@ -->
