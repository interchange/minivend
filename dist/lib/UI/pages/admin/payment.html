[set page_title]Payment options[/set]
[set help_name]payment.main[/set]
[set icon_name]admin/icon_config.gif[/set]
@@UI_STD_HEAD@@

<!-- ----- BEGIN REAL STUFF ----- -->

[flag type=write table=variable]
<!-- ----- BEGIN REAL STUFF ----- -->
[perl tables=variable]
	delete $Scratch->{change_payment};
	return unless $CGI->{change_payment} eq 'do';
	$Scratch->{change_payment} = 1;
	for (my $i = 1; $i < 1000; $i++) {
		last unless defined $CGI->{"cc_accepted$i"};
		push @cc, $CGI->{"cc_accepted$i"};
	}
	$Scratch->{CREDIT_CARDS_ACCEPTED} = join " ", @cc;
	$Scratch->{PO_ACCEPTED} = $CGI->{po};
	$Scratch->{COD_ACCEPTED} = $CGI->{cod};
	$Scratch->{CHECK_ACCEPTED} = $CGI->{check};
	return;
[/perl]
[if scratch change_payment]
[loop list="CREDIT_CARDS_ACCEPTED PO_ACCEPTED COD_ACCEPTED CHECK_ACCEPTED"]
	<!-- [loop-code]: [data table=variable
						col=Variable
						key=[loop-code]
						value="[scratch [loop-code]]"] -->
[/loop]
[/if]
[calc]
		@cc = grep /\S/, split /\s+/,
						tag_data(qw/variable Variable CREDIT_CARDS_ACCEPTED/);
		for (qw/PO_ACCEPTED COD_ACCEPTED CHECK_ACCEPTED/) {
			$Scratch->{$_} = tag_data(qw/variable Variable/, $_);
		}
		for (@cc) {
			$cc{$_} = 1;
		}
		$Scratch->{its} = <<EOF;
visa	VISA	$cc{visa}
mc	Mastercard	$cc{mc}
discover	Discover	$cc{discover}
amex	American Express	$cc{amex}
other	Diners Club/Other	$cc{other}
EOF
		return;
[/calc]
<form action="[area @@MV_PAGE@@]" method=POST>
<INPUT TYPE=hidden NAME=change_payment VALUE=do>

<table cellpadding=3 cellspacing=0>
<tr>
<td colspan=2 bgcolor=#7079aa><img src="admin/cleardot.gif" width=600 height=1></td>
</tr>

<tr>
<td bgcolor=#94a0e0><b>Name</b></td>
<td bgcolor=#94a0e0><b>Accepted</b></td>
</tr>

[loop list="[scratch its]" lr=1]
<tr>

<td bgcolor=#94a0e0>
[loop-pos 1]
</td>

<td bgcolor=#94a0e0>

<select name="cc_accepted[loop-increment]">
<option value=""> Not Accepted
<option value="[loop-code]" [if-loop-pos 2]SELECTED[/if-loop-pos]> Accepted
</select>

</td>
</tr>
[/loop]

<tr>

<td bgcolor=#94a0e0>
Check
</td>

<td bgcolor=#94a0e0>

<select name="check">
<option value="0"> Not Accepted
<option value="1" [if scratch CHECK_ACCEPTED]SELECTED[/if]> Accepted
</select>

</td>

</tr>

<tr>

<td bgcolor=#94a0e0>
COD
</td>

<td bgcolor=#94a0e0>

<select name="cod">
<option value="0"> Not Accepted
<option value="1" [if scratch COD_ACCEPTED]SELECTED[/if]> Accepted
</select>

</td>

</tr>

<tr>

<td bgcolor=#94a0e0>
Purchase Order
</td>

<td bgcolor=#94a0e0>

<select name="po">
<option value="0"> Not Accepted
<option value="1" [if scratch PO_ACCEPTED]SELECTED[/if]> Accepted
</select>

</td>

</tr>
<tr>
<td colspan=2 bgcolor=#7079aa><img src="admin/cleardot.gif" width=600 height=1></td>
</tr>

</table>
[loop list="CREDIT_CARDS_ACCEPTED PO_ACCEPTED COD_ACCEPTED CHECK_ACCEPTED"]
	[set [loop-code]][/set]
[/loop]

<p>

<input type=submit name="update" value="Update">
<br>
<input type=submit name="back" value="Back">

</form>


<!-- ----- END REAL STUFF ----- -->

@@UI_STD_FOOTER@@
<!-- page: @@MV_PAGE@@ -->
